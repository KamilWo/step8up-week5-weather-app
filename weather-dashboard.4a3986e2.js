document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search-modal"),t=document.getElementById("search-modal-trigger"),a=document.getElementById("modal-close-button"),n=document.getElementById("modal-cancel-button"),o=document.getElementById("city-input"),s=document.getElementById("get-weather-button"),l=document.getElementById("city-name"),i=document.querySelector(".weather-description"),d=document.querySelector(".current-temp"),c=document.querySelector(".feels-like"),r=document.getElementById("wind-status"),u=document.getElementById("sunrise-time"),m=document.getElementById("sunset-time"),f=document.getElementById("forecast-list"),g=document.querySelector(".glass-rectangle"),h=document.querySelector(".dashboard-container"),p="",y=e=>{console.error(e),l.textContent="Error",i.textContent=e},w=async e=>{if(!p)return void y("API Key is missing. Please configure it in settings.");l.textContent=`Loading data for ${e}...`,i.textContent="Please wait...";try{let t=`https://api.openweathermap.org/geo/1.0/direct?q=${e}&limit=1&appid=${p}`,a=await fetch(t);if(!a.ok)throw Error("Failed to fetch location data.");let n=await a.json();if(0===n.length)throw Error(`Could not find location: ${e}`);let{lat:o,lon:s}=n[0],y=`https://api.openweathermap.org/data/2.5/weather?lat=${o}&lon=${s}&appid=${p}&units=metric`,w=`https://api.openweathermap.org/data/2.5/forecast?lat=${o}&lon=${s}&appid=${p}&units=metric`,[L,E]=await Promise.all([fetch(y),fetch(w)]);if(!L.ok||!E.ok)throw Error("Failed to fetch weather data.");let $=await L.json(),k=await E.json();(e=>{let{name:t,main:a,weather:n,wind:o,sys:s}=e;l.textContent=t,i.textContent=n[0].description.replace(/\b\w/g,e=>e.toUpperCase()),d.textContent=`${Math.round(a.temp)}\xb0C`,c.textContent=`Feels like ${Math.round(a.feels_like)}\xb0C`,r.textContent=`${o.speed.toFixed(1)} km/h`;let f=new Date(1e3*s.sunrise).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),p=new Date(1e3*s.sunset).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});u.textContent=`Sunrise: ${f}`,m.textContent=`Sunset: ${p}`,((e,t,a)=>{let n=e.main.toLowerCase();Date.now();let o=["sunny","cloudy","partly-cloudy","stormy"];g.classList.remove(...o),h.classList.remove(...o);let s="";n.includes("storm")||n.includes("thunder")?s="stormy":n.includes("cloud")?s=801===e.id?"partly-cloudy":"cloudy":n.includes("clear")&&(s="sunny"),s&&(g.classList.add(s),h.classList.add(s))})(n[0],s.sunrise,s.sunset)})($),f.innerHTML="",k.list.filter(e=>e.dt_txt.includes("12:00:00")).forEach(e=>{let t=new Date(1e3*e.dt).toLocaleDateString("en-GB",{weekday:"short"}),a=`${Math.round(e.main.temp)}\xb0C`,n={"01d":"fas fa-sun","01n":"fas fa-moon","02d":"fas fa-cloud-sun","02n":"fas fa-cloud-moon","03d":"fas fa-cloud","03n":"fas fa-cloud","04d":"fas fa-cloud-meatball","04n":"fas fa-cloud-meatball","09d":"fas fa-cloud-showers-heavy","09n":"fas fa-cloud-showers-heavy","10d":"fas fa-cloud-sun-rain","10n":"fas fa-cloud-moon-rain","11d":"fas fa-bolt","11n":"fas fa-bolt","13d":"fas fa-snowflake","13n":"fas fa-snowflake","50d":"fas fa-smog","50n":"fas fa-smog"}[e.weather[0].icon]||"fas fa-question-circle",o=document.createElement("div");o.className="forecast-item",o.innerHTML=`
        <p class="forecast-day">${t}</p>
        <i class="forecast-icon ${n}"></i>
        <p class="forecast-temp">${a}</p>
      `,f.appendChild(o)})}catch(e){y(e.message)}},L=()=>{e&&(e.classList.add("hidden"),e.classList.remove("flex"))};t&&t.addEventListener("click",t=>{t.preventDefault(),e&&(e.classList.remove("hidden"),e.classList.add("flex"),setTimeout(()=>o.focus(),100))}),a&&a.addEventListener("click",L),n&&n.addEventListener("click",L),e&&e.addEventListener("click",t=>{t.target===e&&L()}),document.addEventListener("keydown",t=>{"Escape"!==t.key||e.classList.contains("hidden")||L()});let E=()=>{let e=o.value.trim();e?(w(e),L(),o.value=""):o.focus()};s&&s.addEventListener("click",E),o&&o.addEventListener("keyup",e=>{"Enter"===e.key&&E()});let $=(()=>{let e=JSON.parse(localStorage.getItem("weatherDashSettings"));return e&&e.apiKey?(p=e.apiKey,e):(y("API Key not found. Please set it in the Settings page."),null)})();$&&($.useGeolocation?navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:a}=e.coords;w(`lat=${t}&lon=${a}`)},e=>{console.warn("Geolocation denied. Falling back to default location.",e),$.defaultLocation&&w($.defaultLocation)}):$.defaultLocation&&w($.defaultLocation))});
//# sourceMappingURL=weather-dashboard.4a3986e2.js.map
